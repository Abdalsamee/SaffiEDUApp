package com.example.saffieduapp.presentation.screens.login

<<<<<<< HEAD
import android.annotation.SuppressLint
=======
>>>>>>> integration&UI
import androidx.compose.foundation.Image
import androidx.compose.foundation.background
import androidx.compose.foundation.clickable
import androidx.compose.foundation.layout.*
import androidx.compose.foundation.rememberScrollState
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.foundation.text.ClickableText
import androidx.compose.foundation.verticalScroll
import androidx.compose.material3.*
<<<<<<< HEAD
import androidx.compose.runtime.Composable
import androidx.compose.runtime.SideEffect
import androidx.compose.runtime.collectAsState
=======
import androidx.compose.runtime.*
>>>>>>> integration&UI
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.draw.clip
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.res.painterResource
import androidx.compose.ui.text.SpanStyle
import androidx.compose.ui.text.buildAnnotatedString
<<<<<<< HEAD
=======
import androidx.compose.ui.text.font.FontWeight
import androidx.compose.ui.text.input.PasswordVisualTransformation
import androidx.compose.ui.text.input.VisualTransformation
>>>>>>> integration&UI
import androidx.compose.ui.text.style.TextAlign
import androidx.compose.ui.text.withStyle
import androidx.compose.ui.unit.dp
import androidx.compose.ui.unit.sp
<<<<<<< HEAD
import androidx.lifecycle.viewmodel.compose.viewModel
import androidx.compose.foundation.layout.imePadding
import com.example.saffieduapp.R
import com.example.saffieduapp.presentation.components.PrimaryButton
import com.example.saffieduapp.presentation.screens.login.components.LoginTextField
import com.example.saffieduapp.ui.theme.*
import com.google.accompanist.systemuicontroller.rememberSystemUiController

@SuppressLint("UnusedBoxWithConstraintsScope")
@Composable
fun LoginScreen(
    viewModel: LoginViewModel = viewModel()
) {
    val state = viewModel.uiState.collectAsState().value
=======
import com.example.saffieduapp.R

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun LoginScreen(
    // 1. ÿ£ÿ∂ŸÅŸÜÿß Ÿáÿ∞ÿß ÿßŸÑÿ®ÿßÿ±ÿßŸÖŸäÿ™ÿ± ŸÑÿ™ŸÑŸÇŸä ÿ£ŸÖÿ± ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ
    onLoginSuccess: () -> Unit
) {
    var id by remember { mutableStateOf("") }
    var password by remember { mutableStateOf("") }
    var isPasswordVisible by remember { mutableStateOf(false) }
    var rememberMe by remember { mutableStateOf(false) }

    val primaryBlue = Color(0xFF3F86F1)
    val backgroundWhite = Color.White
    val borderColor = Color(0xFFD1D1D1)
>>>>>>> integration&UI

    // ‚úÖ ÿßŸÑÿ™ÿ≠ŸÉŸÖ ŸÅŸä ŸÑŸàŸÜ ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ≠ÿßŸÑÿ©
    val systemUiController = rememberSystemUiController()
    val statusBarColor =AppPrimary  // üîµ ÿ¨ÿπŸÑ ÿßŸÑÿ≥ÿ™ÿßÿ™ÿ≥ ÿ®ÿßÿ± ÿ£ÿ≤ÿ±ŸÇ

    SideEffect {
        systemUiController.setStatusBarColor(
            color = statusBarColor,
            darkIcons = false
        )
    }

    BoxWithConstraints(
        modifier = Modifier
            .fillMaxSize()
<<<<<<< HEAD
            .background(AppPrimary)
=======
            .background(primaryBlue)
>>>>>>> integration&UI
    ) {
        val screenHeight = maxHeight
        val screenWidth = maxWidth
        val logoSize = (screenHeight * 0.20f).coerceIn(100.dp, 180.dp)

        Column(
<<<<<<< HEAD
            modifier = Modifier
                .fillMaxSize()
        ) {
            Spacer(modifier = Modifier.height(screenHeight * 0.05f))

            // ‚úÖ ÿßŸÑÿ¥ÿπÿßÿ±
            Image(
                painter = painterResource(id = R.drawable.logo_new__4___4_),
                contentDescription = "Logo",
                modifier = Modifier
                    .size(logoSize)
                    .align(Alignment.CenterHorizontally)
            )

            Spacer(modifier = Modifier.height(screenHeight * 0.05f))

            // ‚úÖ ÿµŸÜÿØŸàŸÇ ÿßŸÑÿ≠ŸÇŸàŸÑ
=======
            modifier = Modifier.fillMaxSize()
        ) {
            Spacer(modifier = Modifier.height(20.dp))

            Image(
                painter = painterResource(id = R.drawable.logo_saffi),
                contentDescription = "Logo",
                modifier = Modifier
                    .size(156.dp)
                    .align(Alignment.CenterHorizontally)
            )

            Spacer(modifier = Modifier.height(24.dp))

>>>>>>> integration&UI
            Box(
                modifier = Modifier
                    .fillMaxWidth()
                    .weight(1f)
<<<<<<< HEAD
                    .clip(RoundedCornerShape(topEnd = screenWidth * 0.25f))
                    .background(AppBackground)
=======
                    .clip(RoundedCornerShape(topEnd = 120.dp))
                    .background(backgroundWhite)
>>>>>>> integration&UI
            ) {
                Column(
                    modifier = Modifier
                        .fillMaxSize()
<<<<<<< HEAD
                        .imePadding()
                        .padding(
                            horizontal = screenWidth * 0.06f,
                            vertical = screenHeight * 0.02f
                        )
                        .verticalScroll(rememberScrollState()),
                    horizontalAlignment = Alignment.CenterHorizontally
                ) {
                    // ‚úÖ ÿßŸÑÿπŸÜŸàÿßŸÜ
                    Text(
                        text = "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ",
                        style = MaterialTheme.typography.displayLarge.copy(
                            fontSize = (screenWidth.value * 0.07).sp
                        ),
                        color = AppTextPrimary,
                        modifier = Modifier.padding(bottom = screenHeight * 0.03f)
                    )

                    // ‚úÖ ÿ≠ŸÇŸÑ ÿ±ŸÇŸÖ ÿßŸÑŸáŸàŸäÿ©
                    LoginTextField(
                        value = state.id,
                        onValueChange = { viewModel.onEvent(LoginEvent.IdChanged(it)) },
                        label = "ÿ±ŸÇŸÖ ÿßŸÑŸáŸàŸäÿ©",
                        placeholder = "123XXXXXXXX",
                        icon = R.drawable.id_user_1,
                        modifier = Modifier
                            .fillMaxWidth()
                            .heightIn(min = screenHeight * 0.065f)
                    )

                    Spacer(modifier = Modifier.height(screenHeight * 0.025f))

                    // ‚úÖ ÿ≠ŸÇŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±
                    LoginTextField(
                        value = state.password,
                        onValueChange = { viewModel.onEvent(LoginEvent.PasswordChanged(it)) },
                        label = "ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±",
                        placeholder = "********",
                        isPassword = true,
                        isPasswordVisible = state.isPasswordVisible,
                        onToggleVisibility = { viewModel.onEvent(LoginEvent.TogglePasswordVisibility) },
                        icon = R.drawable.notvisipel,
                        modifier = Modifier
                            .fillMaxWidth()
                            .heightIn(min = screenHeight * 0.065f)
                    )

                    Spacer(modifier = Modifier.height(screenHeight * 0.02f))

                    // ‚úÖ ÿßŸÑŸÜÿµŸàÿµ ÿßŸÑÿ≥ŸÅŸÑŸäÿ©
=======
                        .padding(horizontal = 32.dp, vertical = 24.dp)
                        .verticalScroll(rememberScrollState()),
                    horizontalAlignment = Alignment.CenterHorizontally
                ) {
                    Text(
                        text = "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ",
                        fontSize = 32.sp,
                        fontWeight = FontWeight.W500,
                        modifier = Modifier.padding(bottom = 24.dp)
                    )

                    OutlinedTextField(
                        value = id,
                        onValueChange = { id = it },
                        modifier = Modifier
                            .fillMaxWidth()
                            .height(64.dp),
                        placeholder = { Text("123XXXXXXXX", textAlign = TextAlign.End) },
                        label = { Text("ÿ±ŸÇŸÖ ÿßŸÑŸáŸàŸäÿ©", textAlign = TextAlign.End) },
                        trailingIcon = {
                            Icon(
                                painter = painterResource(id = R.drawable.arrow_left),
                                contentDescription = null
                            )
                        },
                        singleLine = true,
                        shape = RoundedCornerShape(16.dp),
                        colors = OutlinedTextFieldDefaults.colors(
                            focusedBorderColor = borderColor,
                            unfocusedBorderColor = borderColor,
                            cursorColor = Color.Black
                        ),
                        textStyle = LocalTextStyle.current.copy(textAlign = TextAlign.End)
                    )

                    Spacer(modifier = Modifier.height(16.dp))

                    OutlinedTextField(
                        value = password,
                        onValueChange = { password = it },
                        modifier = Modifier
                            .fillMaxWidth()
                            .height(64.dp),
                        placeholder = { Text("", textAlign = TextAlign.End) },
                        label = { Text("ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±", textAlign = TextAlign.End) },
                        trailingIcon = {
                            IconButton(onClick = { isPasswordVisible = !isPasswordVisible }) {
                                Icon(
                                    painter = painterResource(
                                        id = if (isPasswordVisible)
                                            R.drawable.logo_saffi
                                        else
                                            R.drawable.arrow_left
                                    ),
                                    contentDescription = if (isPasswordVisible)
                                        "ÿ•ÿÆŸÅÿßÿ° ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±"
                                    else
                                        "ÿπÿ±ÿ∂ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±"
                                )
                            }
                        },
                        singleLine = true,
                        shape = RoundedCornerShape(16.dp),
                        visualTransformation = if (isPasswordVisible)
                            VisualTransformation.None
                        else
                            PasswordVisualTransformation(),
                        colors = OutlinedTextFieldDefaults.colors(
                            focusedBorderColor = borderColor,
                            unfocusedBorderColor = borderColor,
                            cursorColor = Color.Black
                        ),
                        textStyle = LocalTextStyle.current.copy(textAlign = TextAlign.End)
                    )

                    Spacer(modifier = Modifier.height(8.dp))

>>>>>>> integration&UI
                    Row(
                        modifier = Modifier.fillMaxWidth(),
                        verticalAlignment = Alignment.CenterVertically
                    ) {
                        Row(
                            modifier = Modifier.weight(1f),
                            verticalAlignment = Alignment.CenterVertically
                        ) {
                            Checkbox(
<<<<<<< HEAD
                                checked = state.rememberMe,
                                onCheckedChange = { viewModel.onEvent(LoginEvent.RememberMeChanged(it)) },
                                colors = CheckboxDefaults.colors(checkedColor = AppPrimary)
                            )
                            Text(
                                text = "ÿ™ÿ∞ŸÉÿ±ŸÜŸä",
                                style = MaterialTheme.typography.bodyMedium,
                                color = AppTextSecondary,
                                textAlign = TextAlign.Start
=======
                                checked = rememberMe,
                                onCheckedChange = { rememberMe = it }
                            )
                            Text(
                                text = "ÿ™ÿ∞ŸÉÿ±ŸÜŸä",
                                color = Color.Gray,
                                fontWeight = FontWeight.W500
>>>>>>> integration&UI
                            )
                        }

                        Text(
                            text = "ŸáŸÑ ŸÜÿ≥Ÿäÿ™ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±ÿü",
<<<<<<< HEAD
                            color = AppTextPrimary,
                            modifier = Modifier.clickable { },
                            style = MaterialTheme.typography.bodyMedium,
                            textAlign = TextAlign.End
                        )
                    }

                    Spacer(modifier = Modifier.height(screenHeight * 0.03f))

                    // ‚úÖ ÿ≤ÿ± ÿßŸÑÿØÿÆŸàŸÑ
                    PrimaryButton(
                        text = "ÿßÿ®ÿØÿ£",
                        onClick = { viewModel.onEvent(LoginEvent.LoginClicked) },
                        modifier = Modifier.fillMaxWidth()
                    )

                    Spacer(modifier = Modifier.height(screenHeight * 0.02f))

                    // ‚úÖ ÿ±ÿßÿ®ÿ∑ ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ
=======
                            color = Color.Black,
                            modifier = Modifier.clickable { },
                            fontWeight = FontWeight.W500
                        )
                    }

                    Spacer(modifier = Modifier.height(24.dp))

                    Button(
                        // 2. ÿπŸÜÿØ ÿßŸÑÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ ÿßŸÑÿ≤ÿ±ÿå ŸÇŸÖ ÿ®ÿ™ŸÜŸÅŸäÿ∞ ÿ£ŸÖÿ± ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ
                        onClick = { onLoginSuccess() },
                        modifier = Modifier
                            .fillMaxWidth()
                            .height(58.dp),
                        shape = RoundedCornerShape(12.dp),
                        colors = ButtonDefaults.buttonColors(containerColor = primaryBlue)
                    ) {
                        Text(
                            text = "ÿßÿ®ÿØÿ£",
                            fontWeight = FontWeight.W500
                        )
                    }

                    Spacer(modifier = Modifier.height(16.dp))

>>>>>>> integration&UI
                    ClickableText(
                        text = buildAnnotatedString {
                            withStyle(
                                style = SpanStyle(
<<<<<<< HEAD
                                    color = AppTextSecondary,
                                    fontSize = MaterialTheme.typography.bodyLarge.fontSize
=======
                                    color = Color.Gray,
                                    fontWeight = FontWeight.W500,
>>>>>>> integration&UI
                                )
                            ) {
                                append("ŸÑŸäÿ≥ ŸÑÿØŸäŸÉ ÿ≠ÿ≥ÿßÿ®ÿü ")
                            }
                            pushStringAnnotation(tag = "signup", annotation = "signup")
                            withStyle(
                                style = SpanStyle(
<<<<<<< HEAD
                                    color = AppTextPrimary,
                                    fontSize = MaterialTheme.typography.bodyLarge.fontSize
=======
                                    color = Color.Black,
                                    fontWeight = FontWeight.W600
>>>>>>> integration&UI
                                )
                            ) {
                                append("ÿßÿ¥ÿ™ÿ±ŸÉ")
                            }
                            pop()
                        },
                        onClick = { offset ->
<<<<<<< HEAD
                            // TODO: ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ
                        },
                        modifier = Modifier
                            .align(Alignment.CenterHorizontally)
                            .fillMaxWidth(),
                        style = MaterialTheme.typography.bodyLarge.copy(
                            textAlign = TextAlign.Center
                        )
=======
                            // ÿ™ŸÜŸÅŸäÿ∞ ÿπŸÜÿØ ÿßŸÑÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ "ÿßÿ¥ÿ™ÿ±ŸÉ"
                        },
                        modifier = Modifier.align(Alignment.CenterHorizontally)
>>>>>>> integration&UI
                    )
                }
            }
        }
    }
}